{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///home/alebueno/repositorio/Curso_Web3/dapp/services/Web3Services.js"],"sourcesContent":["import ABI from \"./ABI.json\";\nimport Web3 from \"web3\";\n\n//endereço de cntrato na BLC\nconst CONTRACT_ADDRESS = \"0xB30527B524b534d6B69b1Dfb0868EbFD342E8d71\";\n\nexport async function doLogin() {\n    if(!window.ethereum) throw new Error(\"MetaMask não encontrada!\");\n\n    // caso seja encontrada alguma conta solicita todas, so arrai de endereço, nao da pra fazer transação\n    // a metamask vai perguntar ao usuario se ele quer ou não mostrar as contas dele\n    const web3 = new Web3(window.ethereum);\n    const accounts = await web3.eth.requestAccounts();\n    if (!accounts || !accounts.length) throw new Error (\"Carteira não encontrada ou não autorizada!\");\n\n    //se confirmada vamos armazenar no navegador\n    localStorage.setItem(\"wallet\", accounts[0]);\n    return accounts[0];\n\n}\n\n// Função que configura a comunicação com o contrato\nfunction getContract(){\n    const web3 = new Web3(window.ethereum);\n    const from = localStorage.getItem(\"wallet\");\n    return new web3.eth.Contract(ABI, CONTRACT_ADDRESS, {from});\n}\n\n//função que vai enviar a campanha para a blockchain. send chama o metamask pra autororizar\nexport async function addCampaign(getCampaign) {\n    const contract = getContract();\n    return contract.methods.addCampaign(getCampaign.title, getCampaign.description, getCampaign.videoUrl, getCampaign.imageUrl).send();\n}\n\n// usa o call para chamar\nexport async function getLastCampaignId(){\n    const contgract = getContract();\n    return contract.methods.nextId().call(); \n}\n\nexport async function getCampaign(id){\n    const contgract = getContract();\n    return contract.methods.campaign(id).call(); \n}\n\nexport async function donate(id, donation){\n    await doLogin();\n    const contgract = getContract();\n    return contract.methods.donate(id).send({\n        value: Web3.utils.toWei(donation, \"ether\")\n    }\n\n    )\n}"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;;;AAEA,4BAA4B;AAC5B,MAAM,mBAAmB;AAElB,eAAe;IAClB,IAAG,CAAC,OAAO,QAAQ,EAAE,MAAM,IAAI,MAAM;IAErC,qGAAqG;IACrG,gFAAgF;IAChF,MAAM,OAAO,IAAI,2JAAA,CAAA,UAAI,CAAC,OAAO,QAAQ;IACrC,MAAM,WAAW,MAAM,KAAK,GAAG,CAAC,eAAe;IAC/C,IAAI,CAAC,YAAY,CAAC,SAAS,MAAM,EAAE,MAAM,IAAI,MAAO;IAEpD,4CAA4C;IAC5C,aAAa,OAAO,CAAC,UAAU,QAAQ,CAAC,EAAE;IAC1C,OAAO,QAAQ,CAAC,EAAE;AAEtB;AAEA,oDAAoD;AACpD,SAAS;IACL,MAAM,OAAO,IAAI,2JAAA,CAAA,UAAI,CAAC,OAAO,QAAQ;IACrC,MAAM,OAAO,aAAa,OAAO,CAAC;IAClC,OAAO,IAAI,KAAK,GAAG,CAAC,QAAQ,CAAC,uFAAA,CAAA,UAAG,EAAE,kBAAkB;QAAC;IAAI;AAC7D;AAGO,eAAe,YAAY,WAAW;IACzC,MAAM,YAAW;IACjB,OAAO,UAAS,OAAO,CAAC,WAAW,CAAC,YAAY,KAAK,EAAE,YAAY,WAAW,EAAE,YAAY,QAAQ,EAAE,YAAY,QAAQ,EAAE,IAAI;AACpI;AAGO,eAAe;IAClB,MAAM,YAAY;IAClB,OAAO,SAAS,OAAO,CAAC,MAAM,GAAG,IAAI;AACzC;AAEO,eAAe,YAAY,EAAE;IAChC,MAAM,YAAY;IAClB,OAAO,SAAS,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI;AAC7C;AAEO,eAAe,OAAO,EAAE,EAAE,QAAQ;IACrC,MAAM;IACN,MAAM,YAAY;IAClB,OAAO,SAAS,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;QACpC,OAAO,2JAAA,CAAA,UAAI,CAAC,KAAK,CAAC,KAAK,CAAC,UAAU;IACtC;AAGJ","debugId":null}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":["file:///home/alebueno/repositorio/Curso_Web3/dapp/app/donate/page.tsx"],"sourcesContent":["\"use client\"\nimport { useEffect, useState } from \"react\";\nimport { getCampaign } from \"@/services/Web3Services\";\nimport { useParams } from \"next/navigation\";\nimport Web3 from \"web3\";\nimport { donate } from \"@/services/Web3Services\";\n\nexport default function Donate(){\n\n    const params = useParams();\n\n    const [getMessage, setMessage] = useState(\"\");\n    const [campaign, setCampaign] = useState({});\n    const [donation, setDonation] = useState(0); // para valores\n\n\n    useEffect(() => {\n        setMessage(\"Buscando campanha ... aguarde...\");\n        getCampaign(params.id)\n            .then(result =>{\n                setMessage(\"\");\n                result.id = params.id;\n                console.log(result);\n                setMessage(JSON.stringify(result));\n                setCampaign(result);\n            })\n            .catch(err => {\n                console.error(err);\n                setMessage(err.getMessage)\n            })\n\n    }, [])\n\n    function onDonationChange(evt){\n        setDonation(evt.target.value);\n    }\n\n    function btnDonateClick(){\n        setMessage(\"Fazendo sua doação ..aguarde\");\n        donate(campaign.id, donation)\n            .then(tx => {\n                setMessage(\" Doação realizada. Obrigado! Em alguns minutos o saldo será atualizado\");\n                setDonation(0);\n            })\n            .catch(err => {\n                console.error(err);\n                setMessage(err.getMessage);\n            })\n\n    }\n\n    return (\n\n        <>\n            <div className=\"container px-4 py-5\"> \n                <h1 className=\"display-5 fw-bold text-body-emphasis lh-1 mb-3\"> Donate Crypto </h1>\n                <p className=\"lead\"> Verifique se esta é a campanha correta antes da doação</p>\n                <hr />\n                    <div className=\"row flex-lg-row-reverse align-itens-center g-5 \" >\n                        <div className=\"col-7\">\n                            {\n                                campaign.videoUrl\n                                ? <iframe width=\"100%\" height={480}  src={`http://www.youtube.com/enbed/${campaign.videoUrl}`}></iframe>\n                                : <img src={campaign.imageUrl} className=\"d-block mx-lg-auto img-fluid\" width={640} height={480} />\n\n                            }\n                        </div>\n                        <div className=\"col-5 mb-5\" style={{ height: 480, scrollbars: true}} >\n                            <h2>{campaign.title} </h2>\n                            <p><strong>Autor:</strong>{campaign.author}</p>\n                            <p className=\"mb-3\">{campaign.description}</p>\n                            <p className=\"mb-3 fst-italic mt-5 \">E ai o que achou do projeto? já foi arrecadado { Web3.utils.fromWei(campaign.balance || 0, \"ether\")} POL nsta Campanha\n                                Quanto você quer doar (em POL) ?\n                            </p>\n                            <div className=\"mb-3\">\n                                <div className=\"input-group\" >\n                                    <input type=\"number\" id=\"donation\" className=\"form-control p-3 w-50\" value={donation} onChange={onDonationChange}/>\n                                    <span className=\"input-group-text\">POL</span>\n                                    <button type=\"button\" className=\"btn btn-primary p-3 w-25\" onClick={btnDonateClick}>Doar</button>\n                                </div>\n                            </div>\n                        </div>\n                        {\n                            getMessage\n                                ?  <div className=\"alert alert-success p-3 col-12\" role=\"alert\"> {getMessage} </div>\n                                :<></>\n                        }        \n                    </div>\n            </div>\n        </>\n    )\n\n\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAAA;AAJA;;;;;;;AAOe,SAAS;IAEpB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,MAAM,CAAC,YAAY,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC1C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,CAAC;IAC1C,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,IAAI,eAAe;IAG5D,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACN,WAAW;QACX,CAAA,GAAA,wHAAA,CAAA,cAAW,AAAD,EAAE,OAAO,EAAE,EAChB,IAAI,CAAC,CAAA;YACF,WAAW;YACX,OAAO,EAAE,GAAG,OAAO,EAAE;YACrB,QAAQ,GAAG,CAAC;YACZ,WAAW,KAAK,SAAS,CAAC;YAC1B,YAAY;QAChB,GACC,KAAK,CAAC,CAAA;YACH,QAAQ,KAAK,CAAC;YACd,WAAW,IAAI,UAAU;QAC7B;IAER,GAAG,EAAE;IAEL,SAAS,iBAAiB,GAAG;QACzB,YAAY,IAAI,MAAM,CAAC,KAAK;IAChC;IAEA,SAAS;QACL,WAAW;QACX,CAAA,GAAA,wHAAA,CAAA,SAAM,AAAD,EAAE,SAAS,EAAE,EAAE,UACf,IAAI,CAAC,CAAA;YACF,WAAW;YACX,YAAY;QAChB,GACC,KAAK,CAAC,CAAA;YACH,QAAQ,KAAK,CAAC;YACd,WAAW,IAAI,UAAU;QAC7B;IAER;IAEA,qBAEI;kBACI,cAAA,8OAAC;YAAI,WAAU;;8BACX,8OAAC;oBAAG,WAAU;8BAAiD;;;;;;8BAC/D,8OAAC;oBAAE,WAAU;8BAAO;;;;;;8BACpB,8OAAC;;;;;8BACG,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAI,WAAU;sCAEP,SAAS,QAAQ,iBACf,8OAAC;gCAAO,OAAM;gCAAO,QAAQ;gCAAM,KAAK,CAAC,6BAA6B,EAAE,SAAS,QAAQ,EAAE;;;;;qDAC3F,8OAAC;gCAAI,KAAK,SAAS,QAAQ;gCAAE,WAAU;gCAA+B,OAAO;gCAAK,QAAQ;;;;;;;;;;;sCAIpG,8OAAC;4BAAI,WAAU;4BAAa,OAAO;gCAAE,QAAQ;gCAAK,YAAY;4BAAI;;8CAC9D,8OAAC;;wCAAI,SAAS,KAAK;wCAAC;;;;;;;8CACpB,8OAAC;;sDAAE,8OAAC;sDAAO;;;;;;wCAAgB,SAAS,MAAM;;;;;;;8CAC1C,8OAAC;oCAAE,WAAU;8CAAQ,SAAS,WAAW;;;;;;8CACzC,8OAAC;oCAAE,WAAU;;wCAAwB;wCAAiD,2JAAA,CAAA,UAAI,CAAC,KAAK,CAAC,OAAO,CAAC,SAAS,OAAO,IAAI,GAAG;wCAAS;;;;;;;8CAGzI,8OAAC;oCAAI,WAAU;8CACX,cAAA,8OAAC;wCAAI,WAAU;;0DACX,8OAAC;gDAAM,MAAK;gDAAS,IAAG;gDAAW,WAAU;gDAAwB,OAAO;gDAAU,UAAU;;;;;;0DAChG,8OAAC;gDAAK,WAAU;0DAAmB;;;;;;0DACnC,8OAAC;gDAAO,MAAK;gDAAS,WAAU;gDAA2B,SAAS;0DAAgB;;;;;;;;;;;;;;;;;;;;;;;wBAK5F,2BACO,8OAAC;4BAAI,WAAU;4BAAiC,MAAK;;gCAAQ;gCAAE;gCAAW;;;;;;iDAC5E;;;;;;;;;;;;;;AAQjC","debugId":null}}]
}